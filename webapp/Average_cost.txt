SELECT role_name, CONCAT(TRUNCATE(AVG(per_hour_salary * total_time),2),'$') as Average_Cost FROM ((SELECT total_time,role_id,activity_id From (Select (freq*time_duration) as total_time, role_id, activity_id, patient_id FROM reports) AS R INNER JOIN (SELECT patient_id FROM patients WHERE checkout IS NOT NULL) AS cPatients ON R.patient_id = cPatients.patient_id) AS Rep INNER JOIN (SELECT role_id, role_name, (salary/8760) AS per_hour_salary FROM `roles`) AS phSalary ON Rep.role_id = phSalary.role_id) GROUP BY role_name